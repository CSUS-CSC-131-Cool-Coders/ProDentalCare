<div class='demo-app'>

  <div class='demo-app-main'>
    <full-calendar [options]="calendarOptions">
      <ng-template #eventContent let-arg>
        <b>{{ arg.event.start | date:'shortTime' }}</b>
        <i>{{ arg.event.title }}</i>
      </ng-template>
    </full-calendar>
  </div>

  <div class='demo-app-sidebar'>

    <!-- Show Appointment Details if an appointment is selected -->
    <div class='demo-app-sidebar-section' *ngIf="selectedAppointment">
      <h2>Appointment Details</h2>
      <p><strong>Date:</strong> {{ selectedAppointment.start | date:'fullDate' }}</p>
      <p><strong>Time:</strong> {{ selectedAppointment.extendedProps['time'] }}</p>
      <p><strong>Dentist:</strong> {{ selectedAppointment.extendedProps['staffMembers'] }}</p>

      <!-- Dentist Notes Section -->
      <p><strong>Notes:</strong></p>
      <textarea [(ngModel)]="selectedAppointment.extendedProps['dentistNotes']" placeholder="Add notes here..."></textarea>
      <button (click)="saveDentistNotes()" [disabled]="!selectedAppointment.extendedProps['dentistNotes']">
        Save Notes
      </button>

      <!-- Close Details Button -->
      <button (click)="closeAppointmentDetails()">Close</button>

      <!-- Cancel Appointment Button -->
      <button (click)="cancelAppointment(selectedAppointment)">Cancel Appointment</button>

      <!-- Leave a Review Button -->
      <button (click)="leaveReview(selectedAppointment)">Leave a Review</button>
    </div>

    <!-- Show Appointments Lists if no appointment is selected and no date is selected -->
    <div class='demo-app-sidebar-section' *ngIf="!selectedDate && !selectedAppointment">
      <!-- Upcoming Appointments -->
      <h2>Upcoming Appointments ({{ upcomingAppointments.length }})</h2>
      <ul>
        <li *ngFor="let appt of upcomingAppointments" (click)="selectAppointment(appt)" style="cursor: pointer;">
          <b>{{ appt.start | date:'shortDate' }}</b>
          <i>Patient ID: {{ appt.title }}</i>
        </li>
      </ul>
    </div>

    <div class='demo-app-sidebar-section' *ngIf="!selectedDate && !selectedAppointment">
      <!-- Past Appointments -->
      <h2>Past Appointments ({{ pastAppointments.length }})</h2>
      <ul>
        <li *ngFor="let appt of pastAppointments" (click)="selectAppointment(appt)" style="cursor: pointer;">
          <b>{{ appt.start | date:'shortDate' }}</b>
          <i>Patient ID: {{ appt.title }}</i>
        </li>
      </ul>
    </div>

    <!-- Appointment Scheduling -->
    <div class='demo-app-sidebar-section' *ngIf="selectedDate && !selectedAppointment">
      <h2>Schedule Appointment on {{ selectedDate | date:'fullDate' }}</h2>

      <!-- Select Staff Member -->
      <label for="staff">Select a Dentist:</label>
      <select id="staff" [(ngModel)]="selectedStaff">
        <option value="" disabled>Select a staff member</option>
        <option *ngFor="let staff of staffs" [value]="staff.staffId">
          {{ staff.firstName }} {{ staff.lastName }} ({{ staff.position }})
        </option>
      </select>

      <!-- Select Time Slot -->
      <label for="time">Select Time Slot:</label>
      <select id="time" [(ngModel)]="selectedTime">
        <option value="" disabled>Select a time slot</option>
        <option *ngFor="let slot of getAvailableSlots()" [value]="slot">
          {{ slot }}
        </option>
      </select>

      <!-- Schedule and Cancel Buttons -->
      <button (click)="scheduleAppointment()" [disabled]="!selectedStaff || !selectedTime">
        Schedule Appointment
      </button>
      <button (click)="cancelBooking()">Cancel</button>
    </div>
  </div>

</div>
